10 C=1:W=0
20 FOR I=0 TO 8:A(I)=1:NEXT I
100 PRINT "COMPUTER FIRST MOVE (Y/N)":K=KEY(0)
110 IF K=89 C=1 ELSE GOTO 120:ELSE GOTO 100
120 IF K=89 C=1: ELSE C=0
130 PRINT "X=COMPUTER, O=HUMAN"
140 IF C=1 CALL 3000:ELSE GOTO 170
150 CALL 2000
160 CALL 4000
161 IF W>0 GOTO 10
170 PRINT "YOUR MOVE (1-9)":INPUT M
180 IF (M<1)+(M>9) GOTO 170
190 IF A(M-1)=1 A(M-1)=5:ELSE GOTO 170
200 CALL 2000
210 CALL 4000
211 IF W>0 GOTO 10
220 IF C=0 CALL 3000:ELSE GOTO 250
230 CALL 2000
240 CALL 4000
241 IF W>0 GOTO 10	
250 GOTO 140
2000 FOR I=0 TO 8
2010 IF A(I)=1 A(I+9)=32
2020 IF A(I)=3 A(I+9)=88
2030 IF A(I)=5 A(I+9)=79
2040 NEXT I
2050 PRINT CHR$(A(9));CHR$(170);CHR$(A(10));CHR$(170);CHR$(A(11))
2051 FOR I=0 TO 5:PRINT CHR$(140);:NEXT I:PRINT
2052 PRINT CHR$(A(12));CHR$(170);CHR$(A(13));CHR$(170);CHR$(A(14))
2053 FOR I=0 TO 5:PRINT CHR$(140);:NEXT I:PRINT
2054 PRINT CHR$(A(15));CHR$(170);CHR$(A(16));CHR$(170);CHR$(A(17))
2060 RETURN
3000 PRINT "THINKING...":K=-1
3010 IF A(0)*A(1)*A(2)=9 K=0
3020 IF A(3)*A(4)*A(5)=9 K=1
3030 IF A(6)*A(7)*A(8)=9 K=2
3040 IF K<0 GOTO 3100
3050 FOR I=0 TO 2
3060 IF A(K*3+I)=1 A(K*3+I)=3
3070 NEXT I
3080 RETURN
3100 K=-1
3110 IF A(0)*A(3)*A(6)=9 K=0
3120 IF A(1)*A(4)*A(7)=9 K=1
3130 IF A(2)*A(5)*A(8)=9 K=2
3140 IF K<0 GOTO 3200
3150 FOR I=0 TO 2
3160 IF A(K+I*3)=1 A(K+I*3)=3
3170 NEXT I
3180 RETURN
3200 K=-1
3210 IF A(0)*A(4)*A(8)=9 K=0
3220 IF A(2)*A(4)*A(6)=9 K=2
3230 IF K<0 GOTO 3300
3240 IF K=0 GOTO 3241:ELSE GOTO 3250
3241 FOR I=0 TO 8 STEP 4
3242 IF A(I)=1 A(I)=3
3243 NEXT I
3244 RETURN
3250 FOR I=2 TO 6 STEP 2
3251 IF A(I)=1 A(I)=3
3252 NEXT I
3260 RETURN
3300 K=-1
3310 IF A(0)*A(1)*A(2)=25 K=0
3320 IF A(3)*A(4)*A(5)=25 K=1
3330 IF A(6)*A(7)*A(8)=25 K=2
3340 IF K<0 GOTO 3400
3350 FOR I=0 TO 2
3360 IF A(K*3+I)=1 A(K*3+I)=3
3370 NEXT I
3380 RETURN
3400 K=-1
3410 IF A(0)*A(3)*A(6)=25 K=0
3420 IF A(1)*A(4)*A(7)=25 K=1
3430 IF A(2)*A(5)*A(8)=25 K=2
3440 IF K<0 GOTO 3500
3450 FOR I=0 TO 2
3460 IF A(K+I*3)=1 A(K+I*3)=3
3470 NEXT I
3480 RETURN
3500 K=-1
3510 IF A(0)*A(4)*A(8)=25 K=0
3520 IF A(2)*A(4)*A(6)=25 K=2
3530 IF K<0 GOTO 3600
3540 IF K=0 GOTO 3541:ELSE GOTO 3550
3541 FOR I=0 TO 8 STEP 4
3542 IF A(I)=1 A(I)=3
3543 NEXT I
3544 RETURN
3550 FOR I=2 TO 6 STEP 2
3551 IF A(I)=1 A(I)=3
3552 NEXT I
3560 RETURN
3600 K=-1
3610 IF A(0)*A(1)*A(2)=3 K=0
3620 IF A(3)*A(4)*A(5)=3 K=1
3630 IF A(6)*A(7)*A(8)=3 K=2
3640 IF K<0 GOTO 3700
3650 FOR I=0 TO 2
3660 IF A(K*3+I)=1 A(K*3+I)=3:I=3
3670 NEXT I
3680 RETURN
3700 K=-1
3710 IF A(0)*A(3)*A(6)=3 K=0
3720 IF A(1)*A(4)*A(7)=3 K=1
3730 IF A(2)*A(5)*A(8)=3 K=2
3740 IF K<0 GOTO 3800
3750 FOR I=0 TO 2
3760 IF A(K+I*3)=1 A(K+I*3)=3:I=3
3770 NEXT I
3780 RETURN
3800 K=-1
3810 IF A(0)*A(4)*A(8)=25 K=0
3820 IF A(2)*A(4)*A(6)=25 K=2
3830 IF K<0 GOTO 3900
3840 IF K=0 GOTO 3841:ELSE GOTO 3850
3841 FOR I=0 TO 8 STEP 4
3842 IF A(I)=1 A(I)=3:I=9
3843 NEXT I
3844 RETURN
3850 FOR I=2 TO 6 STEP 2
3851 IF A(I)=1 A(I)=3:I=7
3852 NEXT I
3860 RETURN
3900 IF A(4)=1 A(4)=3:GOTO 3920
3901 IF A(1)=1 A(1)=3:GOTO 3920
3902 IF A(3)=1 A(3)=3:GOTO 3920
3903 IF A(5)=1 A(5)=3:GOTO 3920
3904 IF A(7)=1 A(7)=3:GOTO 3920
3910 FOR I=0 TO 8
3911 IF A(I)=1 A(I)=3:I=9
3912 NEXT I
3920 RETURN
4000 IF (A(0)*A(1)*A(2)=27)+(A(3)*A(4)*A(5)=27)+(A(6)*A(7)*A(8)=27) W=1
4010 IF (A(0)*A(3)*A(6)=27)+(A(1)*A(4)*A(7)=27)+(A(2)*A(5)*A(8)=27) W=1
4020 IF (A(0)*A(4)*A(8)=27)+(A(2)*A(4)*A(6)=27) W=1
4030 IF (A(0)*A(1)*A(2)=125)+(A(3)*A(4)*A(5)=125)+(A(6)*A(7)*A(8))=125) W=2
4040 IF (A(0)*A(3)*A(6)=125)+(A(1)*A(4)*A(7)=125)+(A(2)*A(5)*A(8))=125 W=2
4050 IF (A(0)*A(4)*A(8)=125)+(A(2)*A(4)*A(6)=125) W=2
4060 J=1
4070 FOR I=0 TO 8
4071 IF A(I)=1 J=0
4072 NEXT I
4080 IF J=1 W=3
4090 IF W=1 PRINT "COMPUTER WIN"
4100 IF W=2 PRINT "YOU WIN!"
4110 IF W=3 PRINT "TIE!"
4120 RETURN
